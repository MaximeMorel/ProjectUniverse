////////////////////////////////////////////////////////////////////////////////
#include "engine.hpp"
#include <unistd.h>
////////////////////////////////////////////////////////////////////////////////
// First create loggers
// Load res manager
// Load default config
// Load global config
// Get application name: --app param ?
// Load app specific config
// Load plugins
// Exec app
////////////////////////////////////////////////////////////////////////////////
Engine* gEngine = nullptr;
////////////////////////////////////////////////////////////////////////////////
Engine::Engine(const std::string& name)
    : m_config()
    , m_logManager()
    , m_resourecManager(m_logManager)
    , m_pluginManager()
    , m_name(name)
{
    setGlobalEngine(*this);
    m_logManager.log() << FILEINFO << "Engine " << m_name << " init..." << std::endl;

    char buf[256];
    m_logManager.log() << getcwd(buf, 256) << std::endl;
}
////////////////////////////////////////////////////////////////////////////////
Engine::~Engine()
{
    m_logManager.log() << "Engine " << m_name << " close..." << std::endl;
}
////////////////////////////////////////////////////////////////////////////////
LogManager& Engine::log()
{
    return m_logManager;
}
////////////////////////////////////////////////////////////////////////////////
ResourceManager& Engine::res()
{
    return m_resourecManager;
}
////////////////////////////////////////////////////////////////////////////////
PluginManager& Engine::plugins()
{
    return m_pluginManager;
}
////////////////////////////////////////////////////////////////////////////////
void setGlobalEngine(Engine& engine)
{
    gEngine = &engine;
}
////////////////////////////////////////////////////////////////////////////////
Engine& getEngine()
{
    return *gEngine;
}
////////////////////////////////////////////////////////////////////////////////
